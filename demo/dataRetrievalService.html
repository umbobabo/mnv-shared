<!DOCTYPE html>
<html>
  <head>
    <script src="../js/basic.js"></script>
    <script src="../js/dataRetrievalService.js"></script>
  </head>
  <body>
    <div id="first">This is the first subscriber</div>
    <div id="second">This is the second subscriber</div>
  <script>

  // First subscriber
  var first = document.getElementById('first');
  var confFirstSubscriber = {
    elements: [first],
    url: 'http://cdn.static-economist.com/sites/default/files/external/minerva_assets/ukel_map/test/0.0.3/results2010revised.json',
    pollingTime: 20000,
    callbackName: 'results2010CB'
  };
  // Subscription to the data retrieval singleton
  /* Public interface to subscribe to the data retrivement
  *  @param {object}
  *  {
  *   'elements': {Array of DOM elements} ID of the object that is subscribing [Mandatory],
  *   'url': {String} URL for data retrieval [Mandatory],
  *   'pollingTime': null {Number} ms value for polling this URL,
  *   'callbackName': {string} Callback name function that is used on the on the jsonp file
  *  }
  */
  MnvDRSI.subscribe(confFirstSubscriber);

  // Listener to intercept the data
  first.addEventListener('dataProvide', function(data){
      console.log('Data received, first obj is ' + data.detail[0].main_id );
      this.innerHTML += '<br>' + data.detail[0].main_id;
    });

  // Second subscriber
  var second = document.getElementById('second');
  var confSecondSubscriber = {
    elements: [second],
    url: 'http://cdn.static-economist.com/sites/default/files/external/minerva_assets/ukel_map/test/0.0.3/results2010revised.json',
    pollingTime: 10000,
    callbackName: 'results2010CB'
  };
  // Subscription to the data retrieval singleton
  MnvDRSI.subscribe(confSecondSubscriber);

  // Listener to intercept the data
  second.addEventListener('dataProvide', function(data){
      console.log('Data received, second obj is ' + data.detail[0].main_id );
      this.innerHTML += '<br>' + data.detail[0].main_id;
    });

  </script>
  </body>
</html>